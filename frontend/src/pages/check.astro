---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { ValidationStatusPoller } from "@/components/ValidationStatusPoller/index";
import { withBasePath } from "@/lib/utils";

// Get document UUID or job ID from query parameters
const documentId = Astro.url.searchParams.get("doc") ?? undefined;
const jobId = Astro.url.searchParams.get("job") ?? undefined;

// If neither is present, redirect to upload page
if (!documentId && !jobId) {
  return Astro.redirect(withBasePath("/upload"), 302);
}
---

<BaseLayout title="Kontrola dokumentu" currentStep="check">
  <div class="container mx-auto py-8">    
    <ValidationStatusPoller 
      client:load
      documentId={documentId}
      jobId={jobId}
    />
  </div>
</BaseLayout>

