---
import { Home, Settings } from "lucide-react";
import "./top-bar.scss";
import { withBasePath } from "@/lib/utils";

// Get current path and normalize it (remove base path and trailing slashes)
const currentPath = Astro.url.pathname.replace(/\/$/, "");
const basePath = import.meta.env.BASE_URL?.replace(/\/$/, "") || "";
const normalizedPath = currentPath.replace(basePath, "") || "/";

// Detect which workflow we're in
const isKvalita = normalizedPath.startsWith("/kvalita");
const isLogistika = normalizedPath.startsWith("/logistika");

// Determine home URL - workflow index or root
let homeUrl = withBasePath("/");
if (isKvalita) {
  homeUrl = withBasePath("/kvalita");
} else if (isLogistika) {
  homeUrl = withBasePath("/logistika");
}

// Show back button only if not on root page or workflow index
const showBackButton = normalizedPath !== "/" && normalizedPath !== "/kvalita" && normalizedPath !== "/logistika";
---

<header class="top-bar">
  <div class="top-bar__container container mx-auto px-2 py-2">
    <!-- Home icon - returns to workflow index or root page -->
    <a
      href={homeUrl}
      class="top-bar__icon"
      aria-label="Zpět na úvodní stránku"
      title="Domů"
    >
      <Home className="top-bar__icon-svg" />
      {showBackButton && <span class="pl-2">Zpět</span>}
    </a>

    <!-- Settings icon -->
    <a
      href={withBasePath("/kvalita/settings")}
      class="top-bar__icon"
      aria-label="Nastavení"
      title="Nastavení"
    >
      <Settings className="top-bar__icon-svg" />
    </a>
  </div>
</header>
